<!DOCTYPE html>
<html>
<head>
  <title>Formulario de Solicitud de Fondos</title>
<style>
  body {
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    background-color: #f3f3f3;
    margin: 0;
    padding: 40px 0;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    min-height: 100vh;
  }

  .container {
    background-color: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    width: 90%;
    max-width: 1200px;
  }

  h2, h3, label {
    color: #333;
    font-weight: 600;
  }

  input[type="text"], input[type="number"], textarea, select {
    font-family: inherit;
    font-size: 15px;
    padding: 8px 10px;
    border: 1px solid #ccc;
    border-radius: 6px;
    margin-top: 5px;
    width: 100%;
    box-sizing: border-box;
  }

  textarea {
    height: 80px;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
    font-size: 14px;
  }

  th, td {
    border: 1px solid #ddd;
    padding: 10px;
    vertical-align: top;
    text-transform: uppercase;
  }

  th {
    background-color: #f2f2f2;
    font-weight: 600;
  }

  button {
    background-color: #0078d4;
    color: white;
    border: none;
    padding: 10px 18px;
    font-size: 14px;
    font-weight: 600;
    border-radius: 6px;
    cursor: pointer;
    transition: background-color 0.2s;
  }

  button:hover {
    background-color: #005fa1;
  }

  .correo-lista {
    margin-top: 30px;
    padding: 15px;
    background-color: #eef3fa;
    border-left: 4px solid #0078d4;
    font-size: 14px;
    border-radius: 5px;
    color: #333;
  }
</style>

</head>
<body>
<div class="container">
  <h2>Formulario de Solicitud de Fondos</h2>

  <h3><label>Asunto:</h3>
    <input type="text" id="asunto" value="SOLICITUD DE FONDOS" required>
  </label>

  <h3><label>Mensaje:</h3>
    <textarea id="mensaje" rows="4" required></textarea>
  </label>

  <h3>Proveedores</h3>
  <button onclick="agregarFila()">Agregar Proveedor</button><br><br>

  <table id="tablaProveedores">
  <thead>
    <tr>
      <th style="width: 10%;">CODIGO OBRA</th>
      <th style="width: 10%;">CI/NIT</th>
      <th style="width: 20%;">NOMBRE O PROVEEDOR</th>
      <th style="width: 30%;">DETALLE</th>
      <th style="width: 15%;">IMPORTE BS</th>
      <th style="width: 10%;">FACTURA</th>
      <th style="width: 5%;"></th>
    </tr>
  </thead>
  <tbody>
      <!-- Filas dinámicas -->
    </tbody>
  </table><br>

  <button onclick="enviarFormulario()">Enviar Solicitud</button>

  <div class="correo-lista">
    <strong>Se enviara el correo a:</strong><br>
    eddy.mendez@toyosa.com<br>
    rodrigo.tejada@toyosa.com<br>
    rosario.saavedra@toyosa.com<br>
    yesenia.orellana@toyosa.com<br>
    karol.caero@toyosa.com<br>
    elvia.terrazas@toyosa.com<br>
    raul.paredes@toyosa.com
  </div>

<script>
  function agregarFila() {
    const tbody = document.getElementById("tablaProveedores").getElementsByTagName("tbody")[0];
    const fila = tbody.insertRow();

    const campos = [
      { tipo: "text" }, // CODIGO OBRA
      { tipo: "text" }, // CI/NIT
      { tipo: "text" }, // NOMBRE
      { tipo: "text" }, // DETALLE
      { tipo: "number", step: "0.01", min: "0" } // IMPORTE BS
    ];

    campos.forEach(c => {
      const celda = fila.insertCell();
      const input = document.createElement("input");
      input.type = c.tipo;
      input.style.width = "100%";
      if (c.tipo === "number") {
        input.step = c.step;
        input.min = c.min;
      }
      celda.appendChild(input);
    });

    // Columna FACTURA
    const celdaFactura = fila.insertCell();
    const selectFactura = document.createElement("select");
    selectFactura.style.width = "100%";
    ["SI", "NO"].forEach(op => {
      const option = document.createElement("option");
      option.value = op;
      option.textContent = op;
      selectFactura.appendChild(option);
    });
    celdaFactura.appendChild(selectFactura);

    // Columna Eliminar
    const celdaAccion = fila.insertCell();
    const btnEliminar = document.createElement("button");
    btnEliminar.textContent = "Eliminar";
    btnEliminar.onclick = () => fila.remove();
    celdaAccion.appendChild(btnEliminar);
  }

  function enviarFormulario() {
    const asunto = document.getElementById("asunto").value.trim();
    const mensaje = document.getElementById("mensaje").value.trim();
    const filas = document.getElementById("tablaProveedores").getElementsByTagName("tbody")[0].rows;

    if (!mensaje) {
      alert("Por favor completa el Mensaje.");
      return;
    }

    if (filas.length === 0) {
      alert("Agrega al menos un proveedor.");
      return;
    }

    let tablaHTML = "<table border='1' style='border-collapse: collapse; width: 100%;'>";
    tablaHTML += "<tr><th>NRO OBRA</th><th>CI</th><th>NOMBRE O PROVEEDOR</th><th>DETALLE</th><th>IMPORTE BS</th><th>FACTURA</th></tr>";

    for (let i = 0; i < filas.length; i++) {
      const inputs = filas[i].querySelectorAll("input");
      const selectFactura = filas[i].querySelector("select");

      tablaHTML += `<tr>
        <td>${inputs[0].value}</td>
        <td>${inputs[1].value}</td>
        <td>${inputs[2].value}</td>
        <td>${inputs[3].value}</td>
        <td>${inputs[4].value}</td>
        <td>${selectFactura.value}</td>
      </tr>`;
    }

    tablaHTML += "</table>";

    const cuerpo = `
      <p>${mensaje}</p>
      <p><strong>PROVEEDORES:</strong></p>
      ${tablaHTML}
    `;

    const tempDiv = document.createElement("div");
    tempDiv.innerHTML = cuerpo;
    document.body.appendChild(tempDiv);

    const range = document.createRange();
    range.selectNodeContents(tempDiv);
    const selection = window.getSelection();
    selection.removeAllRanges();
    selection.addRange(range);

    try {
      document.execCommand("copy");
      alert("El contenido se ha copiado al portapapeles. Se abrirá Outlook para que pegues el contenido con Ctrl + V.");
    } catch (err) {
      alert("No se pudo copiar el contenido automáticamente. Intenta copiarlo manualmente.");
    }

    document.body.removeChild(tempDiv);

    const destinatarios = [
      "eddy.mendez@toyosa.com",
	"rodrigo.tejada@toyosa.com",
	"rosario.saavedra@toyosa.com",
	"yesenia.orellana@toyosa.com",
	"karol.caero@toyosa.com",
	"elvia.terrazas@toyosa.com",
	"raul.paredes@toyosa.com"
    ].join(";");

    const url = `https://outlook.office.com/mail/deeplink/compose?to=${encodeURIComponent(destinatarios)}&subject=${encodeURIComponent(asunto)}`;
    window.open(url, '_blank');
  }
</script>
</div>
</body>
</html>